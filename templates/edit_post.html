<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ê²Œì‹œê¸€ ìˆ˜ì •</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"
    />
    <style>
      .container {
        max-width: 500px;
        background: #fff;
        margin: 50px auto;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
      }
      .title {
        color: #4a4a4a;
        font-size: 1.5rem; /* ì œëª© í¬ê¸° ì¡°ì • */
      }
      .button.is-primary {
        background-color: #3273dc;
        border-radius: 8px;
        width: 50%; /* ë²„íŠ¼ ë„ˆë¹„ í™•ì¥ */
      }

      @font-face {
        font-family: "BMHANNAPro";
        src: url("https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_seven@1.0/BMHANNAPro.woff")
          format("woff");
        font-weight: normal;
        font-style: normal;
      }
      * {
        font-family: "BMHANNAPro", sans-serif;
      }
    </style>
  </head>
  <body class="has-background-light">
    <div class="container">
      <h1 class="title has-text-centered">ê²Œì‹œê¸€ ìˆ˜ì •</h1>

      <div class="field">
        <label class="label">ì œëª©</label>
        <div class="control">
          <input
            class="input"
            type="text"
            id="card_title"
            value="{{ post.card_title }}"
          />
        </div>
      </div>

      <div class="field">
        <label class="label">ë©”ë‰´ ëª©ë¡</label>
        <div class="control">
          <input
            class="input"
            type="text"
            id="menu_list"
            value="{{ post.menu_list }}"
          />
        </div>
      </div>

      <div class="field">
        <label class="label">ìŒì‹ ì¢…ë¥˜</label>
        <div class="control">
          <div class="select">
            <select id="food_type">
              <option>í•œì‹ğŸš</option>
              <option>ì¤‘ì‹ğŸ¥Ÿ</option>
              <option>ì–‘ì‹ğŸ•</option>
              <option>ì¼ì‹ğŸ™</option>
              <option>ê¸°íƒ€</option>
            </select>
          </div>
        </div>
      </div>

      <div class="field">
        <label class="label">ê°€ê²Œ ì •ë³´(URL)</label>
        <div class="control">
          <input
            class="input"
            type="url"
            id="URL_info"
            value="{{ post.URL_info }}"
          />
        </div>
      </div>

      <div class="field">
        <label class="label">ë°°ë‹¬ ë¹„ìš© (ì› ë‹¨ìœ„)</label>
        <div class="control">
          <input
            class="input"
            type="number"
            id="delivery_fee"
            value="{{ post.delivery_fee }}"
          />
        </div>
      </div>

      <div class="field">
        <label class="label">ë§ˆê° ì‹œê°„ (--:--ê¹Œì§€)</label>
        <div class="control">
          <input
            class="input"
            type="time"
            id="end_time"
            value="{{ post.end_time }}"
          />
        </div>
      </div>

      <div class="field">
        <label class="label">ì£¼ë¬¸ì„œ</label>
        <div class="control">
          <!--í…ìŠ¤íŠ¸ ì—ë¦¬ì•„ ì´ê¸° ë•Œë¬¸ì— ë²¨ë¥˜ ê°’ìœ¼ë¡œ ì²˜ë¦¬í•˜ë©´ ê°’ì´ ì•ˆë³´ì¸ë‹¤.-->
          <textarea class="textarea" id="announcement">
{{ post.announcement }}</textarea
          >
        </div>
      </div>

      <div class="field has-text-centered">
        <button
          class="button is-primary"
          onclick="updatePost('{{ post._id }}')"
        >
          ê²Œì‹œê¸€ ìˆ˜ì •
        </button>
      </div>
    </div>

    <script>
      function updatePost(postId) {
        let postData = {
          card_title: document.getElementById("card_title").value,
          menu_list: document.getElementById("menu_list").value,
          food_type: document.getElementById("food_type").value,
          URL_info: document.getElementById("URL_info").value,
          delivery_fee: document.getElementById("delivery_fee").value,
          end_time: document.getElementById("end_time").value,
          announcement: document.getElementById("announcement").value,
        };

        fetch(`/postcard/update/${postId}`, {
          method: "POST",
          headers: {
            "Content-Type": "application/x-www-form-urlencoded",
          },
          body: new URLSearchParams(postData),
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.result === "success") {
              alert("ê²Œì‹œê¸€ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!");
              window.location.href = "/";
            } else {
              alert(data.msg || "ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
            }
          });
      }
    </script>
  </body>
</html>
